

<div class="row little-margin">
  <div class="col-3 first-row">
    <div class="firstcolumn-wrapper container">

      <div class="ourlogo" style="background-color:white;border-radius:7px">
        <%= image_tag "real_logo.png" %>
      </div>

      <div class="personal-info">
        <% if current_user.avatar.attached? %>
          <%= cl_image_tag(current_user.avatar.key, class: "splash-profile-pic") %>
        <% else %>
          <img src="https://education.uky.edu/wp-content/uploads/2019/12/TL-Headshot-2squaresmall.jpg" alt="Profile-picture" class="splash-profile-pic">
        <% end %>
        <div class="user-details">
          <p class="username" style="font-family: 'Nunito Sans';font-weight: 600;padding-bottom: 1vh;color:rgb(94,94,144)">
            <% if current_user %>
              <%= current_user.name %>
            <% end %>
          </p>
          <p class="little-title" style="font-family: 'Nunito Sans';font-weight: 900;font-size:7px;opacity:0.6;">SKILL POINT</p>
          <p class="skill-values" style="font-family: 'Nunito Sans';font-weight: 600;">
            <% if current_user %>
              <%= current_user.skill_rating %>
            <% end %>
          </p>
        </div>
        <i class="fas fa-medal" style="padding-top:2%;padding-left:3%;color:#cc6633;"></i>
      </div>

      <div class="navbarlist">
        <ul>
          <li class="nav-link link-btn home-button"><%= link_to "Home", "/" %></li><hr>
          <% if current_user %>
            <li class="nav-link link-btn"><%= link_to "Profile", "/" %></li><hr>
            <li class="nav-link link-btn"><%= link_to "Messages", user_matches_path(current_user.id) %></li>
              <li class="nav-link match-button"><%= link_to "New Match", new_search_path %></li>
          <% else %>
            <li class="nav-link link-btn"><%= link_to "Login", new_user_session_path %></li><hr>
          <% end %>
        </ul>
        <div class="navbar-card-container">

          <% if current_user %>

            <% current_user.matches.each do |match| %>
              <% sender = match.sender %>
              <% receiver = match.receiver %>


              <div class="navbar-players-mini-card">
                <div class="navbar-mini-card-avatar">
                  <% if sender.id == current_user.id %>
                    <% if receiver.avatar.attached? %>
                      <%= link_to matches_path(match: match.id), data: {turbolinks: :false} do %>
                        <%= cl_image_tag(receiver.avatar.key, class:"navbar-mini-card-avatar") %>
                      <%end%>
                    <% else %>
                      <%= link_to matches_path(match: match.id), data: {turbolinks: :false} do %>
                        <img src="https://pngimage.net/wp-content/uploads/2018/06/no-avatar-png-8.png" alt="avatar" class="navbar-mini-card-avatar">
                      <% end %>
                    <% end %>
                  <% end %>

                  <% if receiver.id == current_user.id %>
                    <% if sender.avatar.attached? %>
                      <%= link_to matches_path(match: match.id), data: {turbolinks: :false} do %>
                        <%=cl_image_tag(sender.avatar.key, class:"navbar-mini-card-avatar") %>
                      <%end%>
                    <% else %>
                      <%= link_to matches_path(match: match.id), data: {turbolinks: :false} do %>
                        <img src="https://pngimage.net/wp-content/uploads/2018/06/no-avatar-png-8.png" alt="avatar" class="navbar-mini-card-avatar">
                      <% end %>
                    <% end %>
                    <hr>
                  <% end %>

                </div>
                <div class="navbar-players-short-description">
                  <% if current_user.id == sender.id %>
                    <h2 style="font-family: 'Nunito Sans';font-weight: 600;padding-bottom: 1%;color:rgb(94,94,144)"><%= receiver.name %></h2><hr>
                  <% else %>
                    <h2 style="font-family: 'Nunito Sans';font-weight: 600;padding-bottom: 1%;color:rgb(94,94,144)"><%= sender.name %></h2><hr>
                  <% end %>
                  <div class="navbar-available-date">
                    <div class="navbar-skill-div">
                      <p class="navbar-skill-availability" style="font-family: 'Nunito Sans';font-weight: 900;font-size:7px;opacity:0.6;">SKILL POINTS</p>
                      <p class="navbar-skill-values" style="font-family: 'Nunito Sans';font-weight: 600;"><%= receiver.skill_rating %></p>
                    </div>
                  </div>
                </div>
                <div class="navbar-chat-icon">
                    <i class="far fa-comment-dots"></i>
                </div>

               </div>
            <% end %>
          <% end %>
          <%# raise %>

        </div>
      </div>
    <%# raise %>
  </div>
</div>

  <div class="col-9" style="overflow-y: scroll; max-height: 60vh;background-color: white;">
    <div id="messages_<%= @match.id %>" class="messagess" data-match-id="<%= @match.id %>">
      <div class="challenge-message" style="height:70px;">
        <% sender = @match.sender %>
        <% receiver = @match.receiver %>

        <div>
          <% if current_user.avatar.attached? %>
            <%= current_user.name %>
            <%=  cl_image_tag(current_user.avatar.key, class: "splash-profile-pic") %>
          <% else %>
            <%= current_user.name %>
            <img src="https://pngimage.net/wp-content/uploads/2018/06/no-avatar-png-8.png" alt="avatar" class="avatar">
          <% end %>
        </div>

        <h5>VS</h5>
        <div>
          <% if current_user.id == sender.id %>
            <% if receiver.avatar.attached? %>
              <%=  cl_image_tag(receiver.avatar.key, class: "splash-profile-pic") %>
              <%= receiver.name %>
            <% else %>
              <img src="https://pngimage.net/wp-content/uploads/2018/06/no-avatar-png-8.png" alt="avatar" class="avatar">
              <%= receiver.name %>
            <% end %>
          <% end %>
        </div>
        <div>
          <% if current_user.id == receiver.id %>
            <% if sender.avatar.attached? %>
              <%=  cl_image_tag(sender.avatar.key, class: "splash-profile-pic") %>
              <%= sender.name %>
            <% else %>
              <img src="https://pngimage.net/wp-content/uploads/2018/06/no-avatar-png-8.png" alt="avatar" class="avatar">
              <%= sender.name %>
            <% end %>
          <% end %>
        </div>
        <div class="match-information">

          <p><%= @match.start_datetime %></p>

        </div>

      </div>
      <div class="message-container">
        <%= sender.name %>
        <br>
        <%= @match.content %>
      </div>
      <% @match.messages.each do |message| %>

        <% if message.user_id == current_user.id %>
          <div class="message-left">
            <%= render "messages/message", message: message %>
          </div>
        <% end %>

        <% if message.user_id != current_user.id %>
          <div class="message-right">
            <%= render "messages/message", message: message %>
          </div>
        <% end %>

      <% end %>
    </div>

    <div style="position: sticky; bottom: 0; height: 50px;">
      <%= simple_form_for [ current_user, @match, @message ] do |f| %>
        <%= f.input :content, label: false, placeholder: "Message", class: "message-input"%>
      <% end %>
    <div>

  </div>
</div>



